<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>타일 크롤러</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.22.0/dist/tf.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.5.1/dist/tfjs-vis.umd.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/knn-classifier@1.2.6/dist/knn-classifier.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.3/dist/coco-ssd.min.js"></script>
</head>
<body>
    <div id="top-menu-bar" class="ui-frame">
        <button class="menu-btn" data-panel-id="inventory-panel">공동 인벤토리</button>
        <button class="menu-btn" data-panel-id="mercenary-panel">용병 부대</button>
        <button class="menu-btn" data-panel-id="squad-management-ui">부대 편성</button>
        <button class="menu-btn" data-panel-id="character-sheet-panel">플레이어 정보</button>
    </div>
    <div id="canvas-container">
        <canvas id="map-base-canvas" class="game-layer"></canvas>
        <canvas id="map-decor-canvas" class="game-layer"></canvas>
        <canvas id="ground-fx-canvas" class="game-layer"></canvas>
        <canvas id="entity-canvas" class="game-layer"></canvas>
        <canvas id="vfx-canvas" class="game-layer"></canvas>
        <canvas id="weather-canvas" class="game-layer"></canvas>
    </div>
    <canvas id="minimap-canvas" class="ui-frame"></canvas>

    <div id="ui-panel" class="ui-frame">
        <h2>플레이어 상태</h2>
        <div class="stats-content-box">
            <div id="basic-status">
                <div class="stat-line">
                    <span>❤️ HP:</span>
                    <span id="ui-player-hp">20</span> /
                    <span id="ui-player-maxHp">20</span>
                </div>
                <div class="hp-bar-container">
                    <div id="ui-hp-bar-fill" class="hp-bar-fill"></div>
                </div>
                <div class="stat-line">
                    <span>💧 MP:</span>
                    <span id="ui-player-mp">0</span> /
                    <span id="ui-player-maxMp">0</span>
                </div>
                <div class="mp-bar-container">
                    <div id="ui-mp-bar-fill" class="mp-bar-fill"></div>
                </div>
                <div class="stat-line">
                    <span>💰 골드:</span>
                    <span id="ui-player-gold">0</span>
                </div>
            </div>
            <div class="exp-bar-container">
                <div id="ui-exp-bar-fill" class="exp-bar-fill"></div>
                <div class="exp-bar-text" id="ui-exp-text">0 / 20</div>
            </div>
            <div id="inventory-section">
                <h3>인벤토리</h3>
                <div id="inventory-slots">
                </div>
            </div>
            <div id="mercenary-controls">
                <button id="hire-mercenary">전사 용병 고용 (50골드)</button>
                <button id="hire-archer">궁수 용병 고용 (50골드)</button>
                <button id="hire-healer">힐러 용병 고용 (50골드)</button>
                <button id="hire-wizard">마법사 용병 고용 (50골드)</button>
                <button id="hire-bard">음유시인 고용 (50골드)</button>
                <button id="hire-summoner">소환사 용병 고용 (50골드)</button>
                <button id="hire-fire-god">불의 신 고용 (100골드)</button>
                <button id="save-game-btn">게임 저장</button>
            </div>
        </div>
    </div>
    <div id="combat-log-panel" class="ui-frame">
        <div id="combat-log-content"></div>
    </div>

    <div id="system-log-panel" class="ui-frame">
        <div class="log-title">-- SYSTEM LOG --</div>
        <div id="system-log-content"></div>
    </div>
    <div id="mercenary-detail-panel" class="modal-panel ui-frame window draggable-window hidden">
        <button id="close-merc-detail-btn" class="close-btn">X</button>
        <h2 id="merc-detail-name" class="window-header">용병 이름</h2>
        <div class="stats-content-box sheet-container">
            <div class="sheet-left">
                <div id="merc-equipment-section">
                    <h3>장비</h3>
                    <div id="merc-equipment" class="equipment-slots">
                        <div class="equip-slot" data-slot="main_hand"></div>
                        <div class="equip-slot" data-slot="off_hand"></div>
                        <div class="equip-slot" data-slot="armor"></div>
                        <div class="equip-slot" data-slot="helmet"></div>
                        <div class="equip-slot" data-slot="gloves"></div>
                        <div class="equip-slot" data-slot="boots"></div>
                        <div class="equip-slot" data-slot="accessory1"></div>
                        <div class="equip-slot" data-slot="accessory2"></div>
                    </div>
                </div>
                <div id="merc-inventory-section">
                    <h3>인벤토리</h3>
                    <div id="merc-inventory"></div>
                </div>
            </div>
            <div class="sheet-right">
                <div id="merc-stats-container"></div>
                <div id="merc-skills-section">
                    <h3>스킬</h3>
                    <div id="merc-skills" class="skill-list"></div>
                </div>
                <div id="reputation-history-panel"></div>
            </div>
        </div>
    </div>

    <div id="equipment-target-panel" class="modal-panel ui-frame window draggable-window hidden">
        <button id="close-equip-target-btn" class="close-btn">X</button>
        <h2 class="window-header">누구에게 장착하시겠습니까?</h2>
        <div id="equipment-target-list">
        </div>
    </div>

    <div id="unequip-panel" class="modal-panel ui-frame window draggable-window hidden">
        <button id="close-unequip-panel" class="close-btn">X</button>
        <h2 class="window-header">장비 해제</h2>
        <div id="unequip-item-name"></div>
        <button id="unequip-confirm-btn">해제</button>
    </div>

    <div id="inventory-panel" class="modal-panel wide ui-frame window draggable-window hidden">
        <button class="close-btn" data-panel-id="inventory-panel">X</button> <h2 class="window-header">🎒 공동 인벤토리</h2>
        <div class="inventory-container">
            <div class="inventory-grid">
            </div>
        </div>
    </div>

    <div id="mercenary-panel" class="modal-panel wide ui-frame window draggable-window hidden">
        <button class="close-btn" data-panel-id="mercenary-panel">X</button>
        <h2 class="window-header">🗡️ 용병 부대</h2>
        <div id="mercenary-list"></div>
    </div>

    <div id="squad-management-ui" class="modal-panel ui-frame window draggable-window hidden">
        <button class="close-btn" data-panel-id="squad-management-ui">X</button>
        <h2 class="window-header">부대 편성</h2>
    </div>

    <!-- 캐릭터 스탯 패널 템플릿 -->
    <div id="character-sheet-template" class="modal-panel ui-frame window draggable-window hidden template">
        <button class="close-btn">X</button>
        <h2 class="window-header"></h2>
        <div class="stats-content-box sheet-container">
            <div class="sheet-left">
                <div class="sheet-equipment equipment-slots"></div>
                <div class="sheet-skills skill-list"></div>
            </div>
            <div class="sheet-right">
                <div class="stats-list"></div>
                <div class="stat-pages"></div>
            </div>
        </div>
    </div>
    <div id="ui-container"></div>

    <div id="skill-bar" class="ui-frame">
        <div class="skill-slot" data-slot-index="0"><span>1</span></div>
        <div class="skill-slot" data-slot-index="1"><span>2</span></div>
        <div class="skill-slot" data-slot-index="2"><span>3</span></div>
    </div>

    <div id="tooltip" class="tooltip ui-frame hidden"></div>

    <script type="module" src="main.js"></script>
</body>
</html>
